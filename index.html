<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BPSR Assist Mobileï¼šé«˜è¦–èªæ€§ãƒŠãƒ“ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ã‚¿ãƒƒãƒ—æ™‚ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’æŠ‘åˆ¶ */
        * { -webkit-tap-highlight-color: transparent; }
        
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #1c1917; 
        }
        ::-webkit-scrollbar-thumb {
            background: #44403c; 
            border-radius: 10px;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            height: 250px;
        }
        @media (min-width: 768px) {
            .chart-container { height: 320px; }
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ–ã®ã‚¹ã‚¿ã‚¤ãƒ«æ”¹å–„ */
        .tab-active {
            border-bottom: 4px solid #f97316;
            color: #ffffff !important;
            font-weight: 800;
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }
    </style>
</head>
<body class="bg-stone-950 text-stone-200 font-sans min-h-screen flex flex-col pb-10">

    <header class="bg-stone-900 shadow-lg border-b border-stone-800 sticky top-0 z-20">
        <div class="max-w-4xl mx-auto px-4 py-3 flex justify-between items-center">
            <div>
                <h1 class="text-lg md:text-2xl font-bold text-white tracking-tight">BPSR Assist Mobile</h1>
                <p class="text-[10px] md:text-sm text-stone-400">ã‚¹ã‚¿ãƒ¬ã‚¾ã®æ´»å‹•ã‚’ã‚¹ãƒãƒ¼ãƒˆã«è¨˜éŒ²</p>
            </div>
            <button onclick="toggleHelp()" class="text-stone-500 hover:text-stone-300 p-2 text-xl">
                â“
            </button>
        </div>
    </header>

    <!-- Help Overlay -->
    <div id="help-overlay" class="fixed inset-0 bg-stone-950/80 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-stone-900 rounded-2xl max-w-sm w-full p-6 shadow-2xl border border-stone-700">
            <h3 class="font-bold text-lg mb-4 text-white">ã‚¹ãƒãƒ›ã§ã®ä½¿ã„æ–¹</h3>
            <ul class="text-sm space-y-3 text-stone-400 mb-6">
                <li>âœ… ç™½ã„æ ï¼ˆã‚¿ã‚¹ã‚¯ï¼‰ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãƒã‚§ãƒƒã‚¯ï¼</li>
                <li>ğŸ”„ ã€ŒRESETã€ã§ãã®ã‚¿ãƒ–ã®ãƒã‚§ãƒƒã‚¯ã‚’ä¸€æ‹¬ã‚¯ãƒªã‚¢</li>
                <li>â° **è‡ªå‹•ãƒªã‚»ãƒƒãƒˆ**: æ¯æ—¥æœ5æ™‚ã«æ—¥èª²ã‚’ã€æœˆæ›œæœ5æ™‚ã«é€±èª²ãƒ»ç‰©è³‡ã‚’è‡ªå‹•ã§ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã€‚</li>
                <li class="pt-2 border-t border-stone-800 font-medium text-stone-200">ã‚¿ãƒ–è¡¨ç¤º:</li>
                <li class="pl-2">æ–‡å­—ã‚’å¤§ããã€è‰²ã‚’æ˜ã‚‹ãã—ã¦æ“ä½œã—ã‚„ã™ãã—ã¾ã—ãŸã€‚</li>
            </ul>
            <button onclick="toggleHelp()" class="w-full bg-orange-600 text-white py-3 rounded-xl font-bold">é–‰ã˜ã‚‹</button>
        </div>
    </div>

    <main class="flex-grow container mx-auto px-4 py-4 max-w-4xl space-y-6">

        <!-- Progress Overview -->
        <section class="bg-stone-900 rounded-2xl shadow-sm p-4 border border-stone-800 overflow-hidden">
            <div class="flex flex-col md:flex-row gap-4 items-center">
                <div class="w-full md:w-1/2">
                    <div class="chart-container">
                        <canvas id="progressRadar"></canvas>
                    </div>
                </div>

                <div class="w-full md:w-1/2 grid grid-cols-1 gap-3">
                    <div class="bg-stone-950/50 p-3 rounded-xl border border-stone-800">
                        <div class="flex justify-between text-xs font-bold mb-1">
                            <span class="text-stone-300">ãƒ‡ã‚¤ãƒªãƒ¼é”æˆåº¦</span>
                            <span id="daily-text" class="text-orange-500">0%</span>
                        </div>
                        <div class="w-full bg-stone-800 rounded-full h-2">
                            <div id="daily-bar" class="bg-orange-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="bg-stone-950/50 p-3 rounded-xl border border-stone-800">
                        <div class="flex justify-between text-xs font-bold mb-1">
                            <span class="text-stone-300">ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼é”æˆåº¦</span>
                            <span id="weekly-text" class="text-stone-400">0%</span>
                        </div>
                        <div class="w-full bg-stone-800 rounded-full h-2">
                            <div id="weekly-bar" class="bg-stone-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="bg-stone-950/50 p-3 rounded-xl border border-stone-800">
                        <div class="flex justify-between text-xs font-bold mb-1">
                            <span class="text-stone-300">ç‰©è³‡æå‡ºçŠ¶æ³</span>
                            <span id="material-text" class="text-amber-500">0%</span>
                        </div>
                        <div class="w-full bg-stone-800 rounded-full h-2">
                            <div id="material-bar" class="bg-amber-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Navigation Tabs - Improved visibility -->
        <nav class="flex bg-stone-800 rounded-xl shadow-md border border-stone-700 overflow-hidden sticky top-[68px] z-10">
            <button onclick="switchTab('daily')" id="tab-daily" class="flex-1 py-4 text-center text-base font-bold transition-all text-stone-400">
                æ—¥èª²
            </button>
            <button onclick="switchTab('weekly')" id="tab-weekly" class="flex-1 py-4 text-center text-base font-bold transition-all text-stone-400">
                é€±èª²
            </button>
            <button onclick="switchTab('materials')" id="tab-materials" class="flex-1 py-4 text-center text-base font-bold transition-all text-stone-400">
                ç‰©è³‡
            </button>
        </nav>

        <div id="content-area" class="pb-10"></div>
    </main>

    <script>
        const dailyData = [
            { id: 'd_guild_att', label: 'ã‚®ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³', desc: 'ã‚®ãƒ«ãƒ‰EXPãƒ»ã‚®ãƒ«ãƒ‰è³‡é‡‘ãƒ»ã‚®ãƒ«ãƒ‰æ´»èºåº¦', category: 'Lifestyle', icon: 'ğŸ¢' },
            { id: 'd_guild_trans', label: 'ã‚®ãƒ«ãƒ‰è¼¸é€', desc: 'ã‚®ãƒ«ãƒ‰ã‚³ã‚¤ãƒ³ãƒ»ãƒ«ãƒ¼ãƒãƒ»å®ç®±ãªã©', category: 'Economy', icon: 'ğŸšš' },
            { id: 'd_shop_myst', label: 'ç¥ç§˜ã‚¹ãƒˆã‚¢', desc: 'æœ€ä¸Šç´šç´ æBOXãƒ»ãƒ©ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ã®æ›¸/å„ªå¾…/ç®±/çµæ™¶', category: 'Economy', icon: 'ğŸ›’' },
            { id: 'd_pioneer_req', label: 'é–‹æ‹“å±€ä¾é ¼', desc: 'ãƒ«ãƒ¼ãƒãƒ»åå£°ãƒ»GCãƒ»ãƒ¡ãƒ€ãƒ«', category: 'Lifestyle', icon: 'ğŸ“œ' },
            { id: 'd_boss_hunt', label: 'ãƒœã‚¹è¨ä¼', desc: 'éµæ¶ˆåŒ–/ã‚¦ã‚£ãƒ«å›å', category: 'Battle', icon: 'ğŸ‘¹' },
            { id: 'd_elite_hunt', label: 'ç²¾é‹­è¨ä¼', desc: 'éµæ¶ˆåŒ–/ã‚¦ã‚£ãƒ«å›å', category: 'Battle', icon: 'ğŸ›¡ï¸' },
            { id: 'd_home_req', label: 'ãƒ›ãƒ¼ãƒ ä¾é ¼', desc: 'ãƒ¬ã‚¢ç´ æã€ãƒ›ãƒ¼ãƒ EXPã€ãƒ›ãƒ¼ãƒ ã‚³ã‚¤ãƒ³ã€ãƒ›ãƒ¼ãƒ è‚¥æ–™', category: 'Lifestyle', icon: 'ğŸ ' },
            { id: 'd_flower', label: 'èŠ±ã®æ ½åŸ¹', desc: 'æ°´ã‚„ã‚Šãƒ»åç©«', category: 'Lifestyle', icon: 'ğŸŒ»' },
            { id: 'd_alch_exp', label: 'éŒ¬é‡‘å®Ÿé¨“', desc: '10EXPÃ—5ãƒ»ç©å…·èŠ±ç«', category: 'Lifestyle', icon: 'âš—ï¸' },
            { id: 'd_unstable', label: 'ä¸å®‰å®šãªç©ºé–“', desc: 'è£…å‚™ãƒ»å¼·åŒ–ç´ æ', category: 'Battle', icon: 'âš”ï¸' },
            { id: 'd_season', label: 'ã‚·ãƒ¼ã‚ºãƒ³æ´»èºåº¦', desc: 'EXPãƒ»GCãƒ»ãƒ«ãƒ¼ãƒãƒ»ã‚·ãƒ¼ã‚ºãƒ³Pãªã©', category: 'Economy', icon: 'ğŸ' },
            { id: 'd_focus', label: 'ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ¶ˆè²»', desc: '400/æ—¥ãƒ»ä¸Šé™2000', category: 'Lifestyle', icon: 'âš¡' },
            { id: 'd_raid', label: 'ãƒ¯ãƒ¼ãƒ«ãƒ‰ãƒ¬ã‚¤ãƒ‰', desc: '20:30ã€œ22:00é–‹å‚¬', category: 'Battle', icon: 'â°' },
            { id: 'd_guild_hunt', label: 'ã‚®ãƒ«ãƒ‰ãƒãƒ³ãƒˆ', desc: 'é‡‘ã€œæ—¥ 10:00ï½24:00 é–‹å‚¬ï¼šã‚®ãƒ«ãƒ‰è²¢çŒ®åº¦ãƒ»ç´ æ', category: 'Battle', icon: 'ğŸ¹', schedule: [5, 6, 0] },
            { id: 'd_guild_dance', label: 'ã‚®ãƒ«ãƒ‰ãƒ€ãƒ³ã‚¹', desc: 'é‡‘ 19:30ï½19:55ï¼šã‚®ãƒ«ãƒ‰è²¢çŒ®åº¦ãƒ»EXP', category: 'Lifestyle', icon: 'ğŸ’ƒ', schedule: [5] }
        ];

        const weeklyData = [
            { id: 'w_shop_gem', label: 'ã‚«ãƒ©ãƒ•ãƒ«(ã‚¸ã‚§ãƒ )', desc: 'ã‚¬ãƒãƒ£ã‚³ã‚¤ãƒ³', category: 'Economy', icon: 'ğŸ’' },
            { id: 'w_shop_friend', label: 'ã‚«ãƒ©ãƒ•ãƒ«(å‹æƒ…)', desc: 'ã‚¸ã‚§ãƒ ', category: 'Economy', icon: 'ğŸ¤' },
            { id: 'w_shop_gc', label: 'ã‚«ãƒ©ãƒ•ãƒ«(GC)', desc: 'å¾¡åº§é‡‘ã€ãƒ«ãƒ¼ãƒ³åˆé‡‘ã€æ¬ ç‰‡ã€çµæ™¶ã€æ”¹é‹³çŸ³ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€å¥¥ç¾©/ãƒ©ãƒ³ã‚¯ã‚¢ãƒƒãƒ—', category: 'Economy', icon: 'ğŸ’³' },
            { id: 'w_shop_fame', label: 'ã‚«ãƒ©ãƒ•ãƒ«(åå£°)', desc: 'ã‚¦ã‚£ãƒ«ã‚³ã‚¤ãƒ³', category: 'Economy', icon: 'ğŸ…' },
            { id: 'w_shop_season', label: 'ã‚·ãƒ¼ã‚ºãƒ³ã‚¹ãƒˆã‚¢', desc: 'ä¸Šç´šç´ æã€è™šè•ã€ãƒ‘ãƒ¯ãƒ¼ãƒ‘ãƒ¼ãƒ„', category: 'Economy', icon: 'ğŸ‚' },
            { id: 'w_shop_guild', label: 'ã‚®ãƒ«ãƒ‰é›‘è²¨å±‹', desc: 'ãƒ•ã‚©ãƒ¼ã‚«ã‚¹å›å¾©å‰¤è³¼å…¥', category: 'Economy', icon: 'ğŸšï¸' },
            { id: 'w_module', label: 'ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«', desc: 'åˆ†è§£ã€äº¤æ›', category: 'Economy', icon: 'âš™ï¸' },
            { id: 'w_pioneer', label: 'é–‹æ‹“è€…è¤’ç« ', desc: 'æœˆæ›œå—å–', category: 'Economy', icon: 'ğŸ›ï¸' },
            { id: 'w_guild_act', label: 'ã‚®ãƒ«ãƒ‰é€±é–“æ´»èºåº¦å ±é…¬', desc: 'ã‚¢ã‚¤ãƒ†ãƒ å ±é…¬ã€æ´»èºåº¦ç¢ºèª', category: 'Lifestyle', icon: 'ğŸ“Š' },
            { id: 'w_regdinis', label: 'ãƒ¬ã‚°ãƒ‡ã‚£ãƒ‹ã‚¹', desc: 'éºè·¡æ”»ç•¥çŠ¶æ³', category: 'Battle', icon: 'ğŸ—¿' },
        ];

        const materialData = [
            { id: 'm_wood', type: 'æœ¨å·¥', req: 'æ¾æ Ã— 40', category: 'Economy' },
            { id: 'm_cryst', type: 'çµæ™¶å­¦', req: 'ç²˜åœŸ80, ç´°ç ‚80, æ¸…ã‚‰ã‹ãªæ¹§æ°´80, å²©å¡©80', category: 'Economy' },
            { id: 'm_botany', type: 'æ¤ç‰©å­¦', req: 'å¹²ã—è‰80, é…¸ã£ã±ã„æœå®Ÿæ¶²ä½“80, åœŸ80, æ¨¹è„‚80', category: 'Economy' },
            { id: 'm_alch', type: 'éŒ¬é‡‘', req: 'è¬ã®çŸ³ã®ç²‰ Ã— 40', category: 'Economy' },
            { id: 'm_forge', type: 'é›é€ ', req: 'é‰„ã‚¤ãƒ³ã‚´ãƒƒãƒˆ Ã— 40', category: 'Economy' },
            { id: 'm_textile', type: 'ç¹”ç‰©', req: 'æ”¹è‰¯ç¶¿å¸ƒ Ã— 20', category: 'Economy' },
            { id: 'm_craft', type: 'å·¥èŠ¸', req: 'ç ‚å²©ã®ç ¥çŸ³ Ã— 40', category: 'Economy' },
            { id: 'm_cook', type: 'æ–™ç†', req: 'å°éº¦ç²‰ Ã— 45', category: 'Economy' },
            { id: 'm_mineral', type: 'é‰±ç‰©å­¦', req: 'ç²˜åœŸ80, ç´°ç ‚80, æ¸…ã‚‰ã‹ãªæ¹§ãæ°´80, é‡‘å±ç ‚80', category: 'Economy' },
        ];

        const savedState = JSON.parse(localStorage.getItem('sr_assist_mobile_v4')) || {
            checked: {},
            lastDailyReset: 0,
            lastWeeklyReset: 0
        };

        let state = {
            checked: savedState.checked || {},
            lastDailyReset: savedState.lastDailyReset || 0,
            lastWeeklyReset: savedState.lastWeeklyReset || 0,
            activeTab: 'daily'
        };

        let myChart = null;

        function getLatestDailyDeadline(now) {
            const deadline = new Date(now);
            deadline.setHours(5, 0, 0, 0);
            if (now < deadline) deadline.setDate(deadline.getDate() - 1);
            return deadline.getTime();
        }

        function getLatestWeeklyDeadline(now) {
            const deadline = new Date(now);
            deadline.setHours(5, 0, 0, 0);
            let day = deadline.getDay();
            let diff = (day === 0) ? 6 : day - 1; 
            deadline.setDate(deadline.getDate() - diff);
            if (now < deadline) deadline.setDate(deadline.getDate() - 7);
            return deadline.getTime();
        }

        function autoResetCheck() {
            const now = Date.now();
            const dailyDeadline = getLatestDailyDeadline(now);
            const weeklyDeadline = getLatestWeeklyDeadline(now);
            let changed = false;

            if (state.lastDailyReset < dailyDeadline) {
                Object.keys(state.checked).forEach(key => {
                    if (key.startsWith('d_')) delete state.checked[key];
                });
                state.lastDailyReset = now;
                changed = true;
            }

            if (state.lastWeeklyReset < weeklyDeadline) {
                Object.keys(state.checked).forEach(key => {
                    if (key.startsWith('w_') || key.startsWith('m_')) delete state.checked[key];
                });
                state.lastWeeklyReset = now;
                changed = true;
            }

            if (changed) save();
        }

        function getVisibleDailyTasks() {
            const today = new Date().getDay();
            return dailyData.filter(task => !task.schedule || task.schedule.includes(today));
        }

        document.addEventListener('DOMContentLoaded', () => {
            autoResetCheck();
            initChart();
            switchTab('daily');
        });

        function toggleHelp() {
            document.getElementById('help-overlay').classList.toggle('hidden');
        }

        function save() {
            const dataToSave = {
                checked: state.checked,
                lastDailyReset: state.lastDailyReset,
                lastWeeklyReset: state.lastWeeklyReset
            };
            localStorage.setItem('sr_assist_mobile_v4', JSON.stringify(dataToSave));
        }

        function toggleTask(id) {
            if (state.checked[id]) delete state.checked[id];
            else state.checked[id] = true;
            save();
            updateUI();
        }

        function resetCategory() {
            const tasks = state.activeTab === 'daily' ? getVisibleDailyTasks() : (state.activeTab === 'weekly' ? weeklyData : materialData);
            tasks.forEach(t => delete state.checked[t.id]);
            save();
            updateUI();
        }

        function updateUI() {
            const visibleDaily = getVisibleDailyTasks();
            const d = getStats(visibleDaily);
            const w = getStats(weeklyData);
            const m = getStats(materialData);

            document.getElementById('daily-text').innerText = `${d.pct}%`;
            document.getElementById('daily-bar').style.width = `${d.pct}%`;
            document.getElementById('weekly-text').innerText = `${w.pct}%`;
            document.getElementById('weekly-bar').style.width = `${w.pct}%`;
            document.getElementById('material-text').innerText = `${m.pct}%`;
            document.getElementById('material-bar').style.width = `${m.pct}%`;

            if (myChart) {
                myChart.data.datasets[0].data = getRadarValues();
                myChart.update();
            }
            renderList();
        }

        function getStats(data) {
            const done = data.filter(item => state.checked[item.id]).length;
            return { pct: data.length ? Math.round((done / data.length) * 100) : 0 };
        }

        function getRadarValues() {
            let scores = { Battle: {d:0,t:0}, Lifestyle: {d:0,t:0}, Economy: {d:0,t:0} };
            const visibleDaily = getVisibleDailyTasks();
            [...visibleDaily, ...weeklyData, ...materialData].forEach(item => {
                scores[item.category].t++;
                if (state.checked[item.id]) scores[item.category].d++;
            });
            return [
                scores.Battle.t ? (scores.Battle.d / scores.Battle.t) * 100 : 0,
                scores.Lifestyle.t ? (scores.Lifestyle.d / scores.Lifestyle.t) * 100 : 0,
                scores.Economy.t ? (scores.Economy.d / scores.Economy.t) * 100 : 0
            ];
        }

        function initChart() {
            const ctx = document.getElementById('progressRadar').getContext('2d');
            myChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['ãƒãƒˆãƒ«', 'ç”Ÿæ´»', 'çµŒæ¸ˆ'],
                    datasets: [{
                        data: [0, 0, 0],
                        backgroundColor: 'rgba(249, 115, 22, 0.25)',
                        borderColor: 'rgb(249, 115, 22)',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: 'rgb(249, 115, 22)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            suggestedMin: 0,
                            suggestedMax: 100,
                            ticks: { display: false, stepSize: 20 },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            angleLines: { color: 'rgba(255, 255, 255, 0.1)' },
                            pointLabels: { font: { size: 10, weight: 'bold' }, color: '#a8a29e' }
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        function switchTab(name) {
            state.activeTab = name;
            ['daily', 'weekly', 'materials'].forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                if (t === name) {
                    btn.classList.add('tab-active');
                    btn.classList.remove('text-stone-400');
                } else {
                    btn.classList.remove('tab-active');
                    btn.classList.add('text-stone-400');
                }
            });
            updateUI();
        }

        function renderList() {
            const container = document.getElementById('content-area');
            container.innerHTML = '';

            const header = document.createElement('div');
            header.className = 'flex justify-between items-center py-4 animate-fade-in';
            const days = ["æ—¥", "æœˆ", "ç«", "æ°´", "æœ¨", "é‡‘", "åœŸ"];
            const now = new Date();
            const dateStr = `${now.getMonth()+1}/${now.getDate()}(${days[now.getDay()]})`;

            header.innerHTML = `
                <span class="text-[10px] font-bold text-stone-500 tracking-widest uppercase">
                    ${state.activeTab === 'daily' ? `TODAY [${dateStr}]` : (state.activeTab === 'weekly' ? 'WEEKLY' : 'MATERIALS')}
                </span>
                <button onclick="resetCategory()" class="text-[10px] font-bold bg-stone-900 text-stone-400 px-3 py-1 rounded-full border border-stone-800 active:scale-95 transition-transform">
                    RESET
                </button>
            `;
            container.appendChild(header);

            if (state.activeTab === 'materials') {
                const grid = document.createElement('div');
                grid.className = 'grid grid-cols-2 gap-3 animate-fade-in';
                materialData.forEach(item => {
                    const isChecked = state.checked[item.id];
                    grid.innerHTML += `
                        <div onclick="toggleTask('${item.id}')" 
                            class="border rounded-2xl p-3 transition-all active:scale-95 shadow-lg ${isChecked ? 'bg-stone-800 border-transparent' : 'bg-white border-transparent'}">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-[9px] font-black uppercase tracking-tighter text-stone-400">${item.type}</span>
                                <span class="text-xs">${isChecked ? 'âœ…' : 'ğŸ“¦'}</span>
                            </div>
                            <p class="text-[11px] font-bold leading-tight ${isChecked ? 'text-stone-200 line-through opacity-60' : 'text-stone-800'}">${item.req.replace(/, /g, '<br>')}</p>
                        </div>
                    `;
                });
                container.appendChild(grid);
            } else {
                const list = document.createElement('div');
                list.className = 'space-y-3 animate-fade-in';
                const data = state.activeTab === 'daily' ? getVisibleDailyTasks() : weeklyData;
                data.forEach(item => {
                    const isChecked = state.checked[item.id];
                    list.innerHTML += `
                        <div onclick="toggleTask('${item.id}')" 
                            class="flex items-center p-4 rounded-2xl border transition-all active:scale-[0.98] shadow-md ${isChecked ? 'bg-stone-800 border-transparent' : 'bg-white border-transparent'}">
                            <div class="w-10 h-10 rounded-full flex items-center justify-center text-xl mr-4 border ${isChecked ? 'bg-stone-700 border-stone-600' : 'bg-stone-100 border-stone-200'}">
                                ${item.icon}
                            </div>
                            <div class="flex-1 ${isChecked ? 'text-stone-200 line-through opacity-60' : ''}">
                                <h4 class="text-sm font-bold ${isChecked ? 'text-white' : 'text-stone-800'}">${item.label}</h4>
                                <p class="text-[10px] ${isChecked ? 'text-stone-300' : 'text-stone-500'} mt-0.5">${item.desc}</p>
                            </div>
                            <div class="w-6 h-6 rounded-full border-2 flex items-center justify-center ${isChecked ? 'bg-orange-500 border-orange-500' : 'border-stone-200'}">
                                ${isChecked ? '<span class="text-white text-[10px]">âœ”</span>' : ''}
                            </div>
                        </div>
                    `;
                });
                container.appendChild(list);
            }
        }
    </script>
</body>
</html>